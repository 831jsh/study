TL;DR
=====

도커가 시작될 때 호스트 머신에 docker0이라 불리는 가상 인터페이스를 생성합니다. 
랜덤으로 실행되는 호스트 머신에 없는 RFC 1918에 의해 정의된 private한 범위에서 ip 주소와 서브넷를 선택합니다.  
그리고 아이피를 docker0에 할당합니다. 도커가 시작되기 몇 분 전에 도커는 172.17.42.1/16 중에 하나를 선택합니다.  
예를 들어 16 bit netmask는 호스트머신과 컨테이너를 위해 65,534 주소를 제공합니다.
맥 어드레스는 ARP 충돌을 피하고 할당된 컨테이너의 ip어드레스를 사용하기 위해  2 66 172 17 0 0 ~ 2 66 172 17 255 255 범위에서 생성됩니다. 

docker0은 평범한 인터페이스는 아닙니다. 
그것은 자동으로 다른 접근 가능한 네트워크 인터페이스와 패킷 포워드를 하기위한 가상 이더넷 브릿지 입니다. 
컨테이너가 호스트 머신과 다른 것들과 통신을 가능케 합니다. 

도커는 매번 컨테이너를 만들 때 한쪽에서 패킷을 보내고 다른 쪽에서 받을 수 있는 파이프와 같은 짝을 이루는 peers 인터페이스를 생성합니다. 
컨테이너를 위한 peer는 vethAQI2QT와 같은 유일한 이름을 주어 eth0 인터페이스가 되고 다른 피어와 연결을 유지합니다. 
모든 veth* 인터페이스는 docker0 브릿지와 바인딩에 의해 도커는 호스트 머신과 모든 도커 컨테이너와 공유된 가상 subnet을 생성합니다. 

Configuring DNS
===============
도커는 호스트네임과 DNS 설정을 어떻게 지원할까요? 최신 정보를 작성할 수 있도록 가상화한 파일을 etc에 오버레이합니다.  
실행 중인 컨테이너에서 mount 명령어를 치면 볼 수 있습니다. 

도커는 resolv.conf(네임서버 정보가 담겨있음) 를 호스트 머신이 새로운 DHCP 정보를 받을 때 최신 상태로 유지시킵니다. 이 방식에 대한 정보는 도커 다음 버전에서 
변경될 수도 있으니 파일은 수정하지 말고 옵션을 사용하도록 합니다. 

- -h, --hostname /etc/hostname과 /etc/hosts에 설정됨, 프롬프트에도 이 이름으로 보임, 하지만 다른 컨테이너나 데몬에서는 볼 수 없음
- --link 이 옵션을 사용하면 /etc/hosts에 ip와 alias 정보가 기록된다. 컨테이너가 재실행하면 link 정보는 변경되지 않는다. 
- --dns 옵션을 사용하면 /etc/resolv.conf의 정보로 기록된다. 
- --dns-search 옵션을 사용하면 dns 정보를 서치해 /etc/resolv.conf에 기록한다. 

Communication between containers and the wider world

